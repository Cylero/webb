<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XXç”µå•†Â·è¿è¥åå°Â·è®¢å•å½•å…¥ä¸é”€å”®çœ‹æ¿</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .box { border: 1px solid #ddd; padding: 20px; margin: 15px 0; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .clock { font-size: 24px; font-weight: bold; color: #2c3e50; text-align: center; padding: 15px; background-color: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef; }
        label { display: inline-block; width: 120px; margin-right: 10px; text-align: right; }
        table { border-collapse: collapse; width: 100%; margin-top: 15px; }
        th, td { border: 1px solid #dee2e6; padding: 10px; text-align: center; }
        th { background-color: #f8f9fa; font-weight: 600; }
        .form-group { margin: 15px 0; display: flex; align-items: center; }
        button { padding: 8px 16px; background: #4299e1; color: #fff; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; }
        button:hover { background: #3182ce; }
        input, select { padding: 6px 10px; border: 1px solid #ced4da; border-radius: 4px; flex: 1; max-width: 300px; }
        h1, h3 { color: #2c3e50; }
        .tip-box { padding: 12px; margin: 15px 0; border-left: 5px solid; border-radius: 4px; }
        .success-tip { background-color: #e6fffa; border-color: #38b2ac; }
        .warning-tip { background-color: #fffbe6; border-color: #ed8936; }
        .info-tip { background-color: #f0f8fb; border-color: #4299e1; }
    </style>
</head>
<body>
    <h1>XXç”µå•†Â·è¿è¥åå°Â·è®¢å•å½•å…¥ä¸é”€å”®çœ‹æ¿</h1>
    <p>æ¬¢è¿ä½¿ç”¨å†…éƒ¨å·¥å…·ï¼Œå®æ—¶æŸ¥çœ‹è®¢å•ä¸é”€å”®æƒ…å†µã€‚</p>

    <div class="box">
        <h3>å½“å‰ç³»ç»Ÿæ—¶é—´</h3>
        <div class="clock" id="clock"></div>
    </div>


    <div class="tip-box info-tip">
        <strong>åº—é“ºä¼˜æƒ æ”¿ç­–ï¼š</strong>
        <ul style="margin:8px 0 0 20px; line-height:1.6;">
            <li>VIP å®¢æˆ·äº«å—<strong>9 æŠ˜ä¼˜æƒ </strong></li>
            <li>åŠ æ€¥å‘è´§ä»·æ ¼ä¼š<strong>Ã—1.1 åŠ ä»·</strong></li>
            <li>æ¯å°æ—¶å‰10 åˆ†é’Ÿäº«å— <strong>8.5 æŠ˜</strong>æ—¶æ®µä¼˜æƒ </li>
            <li>å‰10åˆ†é’Ÿ+è´­ä¹°â‰¥5ä»¶ï¼Œå†å åŠ <strong>8æŠ˜</strong>ï¼ˆç›¸å½“äº 8.5æŠ˜Ã—8æŠ˜=6.8æŠ˜ï¼‰</li>
        </ul>
    </div>

    <div id="timeDiscountTip" class="tip-box warning-tip"></div>

    <div class="box">
        <h3>æ–°å»ºè®¢å•</h3>
        <form onsubmit="return validateForm()">
            <div class="form-group">
                <label>å®¢æˆ·åç§°:</label>
                <input type="text" id="customerName" placeholder="è¯·è¾“å…¥å®¢æˆ·åç§°" required>
            </div>
            <div class="form-group">
                <label>å•†å“å•ä»·(Â¥):</label>
                <input type="number" id="priceInput" step="0.01" placeholder="è¯·è¾“å…¥å¤§äº0çš„æ•°å­—" min="0.01" required>
            </div>
            <div class="form-group">
                <label>è´­ä¹°æ•°é‡(ä»¶):</label>
                <input type="number" id="qtyInput" placeholder="è¯·è¾“å…¥å¤§äº0çš„æ•´æ•°" min="1" required>
            </div>
            <div class="form-group">
                <label>å®¢æˆ·ç±»å‹:</label>
                <select id="customerType" required>
                    <option value="normal">æ™®é€šå®¢æˆ·</option>
                    <option value="vip">VIPå®¢æˆ·</option>
                </select>
            </div>
            <div class="form-group">
                <label>åŠ æ€¥å‘è´§:</label>
                <input type="checkbox" id="urgentFlag" style="width: auto; max-width: none; margin-left: 10px;"> æ˜¯
            </div>
            <div class="form-group" style="justify-content: center; margin-top: 20px;">
                <button type="submit">æäº¤è®¢å•</button>
            </div>
        </form>
    </div>

    <div class="box" id="orderResult"></div>

    <div class="box" id="dashboard"></div>
    <div class="box" id="orderTable"></div>

    <script>
        function padZero(n) {
            return n < 10 ? "0" + n : n;
        }

        function updateClock() {
            var now = new Date();
            var y = now.getFullYear();
            var m = now.getMonth() + 1; 
            var d = now.getDate();
            var hh = now.getHours();
            var mm = now.getMinutes();
            var ss = now.getSeconds();
            var weekNames = ["æ—¥", "ä¸€", "äºŒ", "ä¸‰", "å››", "äº”", "å…­"];
            var w = weekNames[now.getDay()];
            var timeStr = `${y}å¹´${padZero(m)}æœˆ${padZero(d)}æ—¥ æ˜ŸæœŸ${w} ${padZero(hh)}:${padZero(mm)}:${padZero(ss)}`;
            document.getElementById("clock").innerHTML = timeStr;

            updateTimeDiscountTip(mm);
        }

        function updateTimeDiscountTip(minute) {
            var tipEl = document.getElementById("timeDiscountTip");
            if (minute >= 0 && minute <= 9) {
                tipEl.innerHTML = `<strong>ğŸ”¥ æ—¶æ®µä¼˜æƒ ç”Ÿæ•ˆä¸­ï¼</strong> å½“å‰ä¸ºæ¯å°æ—¶å‰10åˆ†é’Ÿï¼Œå¯äº«å—8.5æŠ˜ä¼˜æƒ ï¼›è‹¥è´­ä¹°â‰¥5ä»¶ï¼Œå†å åŠ 8æŠ˜ï¼`;
                tipEl.className = "tip-box success-tip";
            } else {
                tipEl.innerHTML = `<strong>â° æ—¶æ®µä¼˜æƒ æç¤ºï¼š</strong> æ¯ä¸ªæ•´ç‚¹å‰10åˆ†é’Ÿå¯äº«å—8.5æŠ˜ä¼˜æƒ ï¼Œè´­ä¹°â‰¥5ä»¶è¿˜èƒ½å åŠ 8æŠ˜ï¼Œè¯·ç•™æ„ä¸‹å•æ—¶é—´~`;
                tipEl.className = "tip-box warning-tip";
            }
        }

        var orders = [];

        function validateForm() {
            var name = document.getElementById("customerName").value.trim();
            var price = parseFloat(document.getElementById("priceInput").value);
            var quantity = parseInt(document.getElementById("qtyInput").value, 10);
            var customerType = document.getElementById("customerType").value;
            var isUrgent = document.getElementById("urgentFlag").checked;

            if (!name) {
                alert("å®¢æˆ·åç§°ä¸èƒ½ä¸ºç©ºï¼");
                return false;
            }

            if (isNaN(price) || price <= 0) {
                alert("å•†å“å•ä»·å¿…é¡»æ˜¯å¤§äº0çš„æ•°å­—ï¼");
                return false;
            }

            if (isNaN(quantity) || quantity <= 0) {
                alert("è´­ä¹°æ•°é‡å¿…é¡»æ˜¯å¤§äº0çš„æ•´æ•°ï¼");
                return false;
            }

            processOrder(name, price, quantity, customerType === "vip", isUrgent);
            return false; 
        }

        function processOrder(customerName, price, quantity, isVip, isUrgent) {
            var baseTotal = price * quantity;
            var finalTotal = baseTotal;

            var discountLogs = [];

            if (isVip) {
                finalTotal *= 0.9;
                discountLogs.push("VIPå®¢æˆ·9æŠ˜");
            } else {
                discountLogs.push("æ™®é€šå®¢æˆ·æ— VIPä¼˜æƒ ");
            }

            if (isUrgent) {
                finalTotal *= 1.1;
                discountLogs.push("åŠ æ€¥å‘è´§Ã—1.1");
            } else {
                discountLogs.push("æœªåŠ æ€¥å‘è´§");
            }

            var now = new Date();
            var minute = now.getMinutes();
            var hitTimeDiscount = minute >= 0 && minute <= 9;
            if (hitTimeDiscount) {
                finalTotal *= 0.85;
                discountLogs.push("æ¯å°æ—¶å‰10åˆ†é’Ÿ8.5æŠ˜");
            } else {
                discountLogs.push("æœªå‘½ä¸­æ—¶æ®µä¼˜æƒ ");
            }

            if (hitTimeDiscount && quantity >= 5) {
                finalTotal *= 0.8;
                discountLogs.push("<strong>ä¸“å±ï¼šå åŠ 8æŠ˜</strong>");
            }

            var orderType = (isVip && finalTotal > 1000) ? "å¤§é¢VIPè®¢å•" : "æ™®é€šè®¢å•";

            document.getElementById("orderResult").innerHTML = `
                <h3>ğŸ“Š è®¢å•æäº¤æˆåŠŸï¼</h3>
                <p>å®¢æˆ·åç§°ï¼š${customerName}</p>
                <p>å•†å“å•ä»·ï¼šÂ¥${price.toFixed(2)}</p>
                <p>è´­ä¹°æ•°é‡ï¼š${quantity}ä»¶</p>
                <p>åŸºç¡€é‡‘é¢ï¼šÂ¥${baseTotal.toFixed(2)}</p>
                <p>æœ€ç»ˆé‡‘é¢ï¼š<span style="color: #e53e3e; font-size: 18px; font-weight: bold;">Â¥${finalTotal.toFixed(2)}</span></p>
                <p>è®¢å•ç±»å‹ï¼š${orderType}</p>
                <div style="margin-top: 10px; padding: 10px; background-color: #f8f9fa; border-radius: 4px;">
                    <strong>ä¼˜æƒ æ˜ç»†ï¼š</strong>${discountLogs.join(" â†’ ")}
                </div>
            `;

            orders.push({
                name: customerName,
                price: price,
                quantity: quantity,
                baseTotal: baseTotal,
                finalTotal: finalTotal,
                isVip: isVip,
                isUrgent: isUrgent,
                hitTimeDiscount: hitTimeDiscount,
                orderTime: now.toLocaleString()
            });

            updateDashboard();
        }

        function updateDashboard() {
            var orderCount = orders.length;
            var totalSales = orders.reduce((sum, order) => sum + order.finalTotal, 0);
            var avgOrderPrice = orderCount > 0 ? totalSales / orderCount : 0;

            document.getElementById("dashboard").innerHTML = `
                <h3>ğŸ“ˆ é”€å”®çœ‹æ¿</h3>
                <p>ç´¯è®¡è®¢å•æ•°ï¼š${orderCount} å•</p>
                <p>é”€å”®æ€»é¢ï¼šÂ¥${totalSales.toFixed(2)}</p>
                <p>å¹³å‡å®¢å•ä»·ï¼šÂ¥${avgOrderPrice.toFixed(2)}</p>
            `;

            updateOrderTable();
        }

        function updateOrderTable() {
            if (orders.length === 0) {
                document.getElementById("orderTable").innerHTML = "<h3>ğŸ“œ å†å²è®¢å•è®°å½•</h3><p>æš‚æ— å†å²è®¢å•</p>";
                return;
            }

            var tableHtml = `
                <h3>ğŸ“œ å†å²è®¢å•è®°å½•</h3>
                <table>
                    <tr>
                        <th>ä¸‹å•æ—¶é—´</th>
                        <th>å®¢æˆ·åç§°</th>
                        <th>å•ä»·(Â¥)</th>
                        <th>æ•°é‡(ä»¶)</th>
                        <th>åŸºç¡€é‡‘é¢(Â¥)</th>
                        <th>æœ€ç»ˆé‡‘é¢(Â¥)</th>
                        <th>VIP</th>
                        <th>åŠ æ€¥</th>
                        <th>æ—¶æ®µä¼˜æƒ </th>
                    </tr>
            `;

            orders.forEach(order => {
                tableHtml += `
                    <tr>
                        <td>${order.orderTime}</td>
                        <td>${order.name}</td>
                        <td>${order.price.toFixed(2)}</td>
                        <td>${order.quantity}</td>
                        <td>${order.baseTotal.toFixed(2)}</td>
                        <td style="color: #e53e3e; font-weight: 600;">${order.finalTotal.toFixed(2)}</td>
                        <td>${order.isVip ? "æ˜¯" : "å¦"}</td>
                        <td>${order.isUrgent ? "æ˜¯" : "å¦"}</td>
                        <td>${order.hitTimeDiscount ? "æ˜¯" : "å¦"}</td>
                    </tr>
                `;
            });

            tableHtml += "</table>";
            document.getElementById("orderTable").innerHTML = tableHtml;
        }

    
        updateClock();
        setInterval(updateClock, 1000);


        updateDashboard();
    </script>
</body>
</html>